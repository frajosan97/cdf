import{u as d,j as e,H as j,b as f}from"./app-BHvGR4js.js";import{A as w}from"./AuthenticatedLayout-BzUGl44w.js";import{C as v,B as a}from"./Container-p98MeQ5k.js";import{C as n}from"./Card-pGXOtwt2.js";import{A as m}from"./Alert-CWilNkyM.js";import{F as r}from"./Form-Q2j9ICbV.js";import"./ApplicationLogo-hP5aVGpV.js";import"./createLucideIcon-DHdMkeD_.js";import"./Nav-DifuSH0a.js";import"./Fade-C5nPZceD.js";import"./CloseButton-DQ3VpcOX.js";import"./warning-CjFOLJzl.js";import"./InputGroupContext-CBrQ1b5Q.js";import"./Col-DwigXgel.js";function L({auth:u,status:i}){const c=u.user,p=c?.two_factor_enabled??!1,s=d({password:""}),o=d({code:""}),h=t=>{t.preventDefault(),s.post(route("two-factor.enable"),{preserveScroll:!0,onSuccess:()=>s.reset()})},x=t=>{t.preventDefault(),o.post(route("two-factor.confirm"),{preserveScroll:!0,onSuccess:()=>o.reset()})},b=t=>{t.preventDefault(),f.delete(route("two-factor.disable"),{preserveScroll:!0})},l=c?.two_factor_qr_code_url??"";return e.jsxs(w,{children:[e.jsx(j,{title:"Two-Factor Authentication"}),e.jsx(v,{fluid:!0,children:e.jsxs(n,{className:"border-0 shadow",children:[e.jsx(n.Header,{className:"border-0 bg-transparent",children:e.jsx("h5",{className:"mb-0",children:"Two-Factor Authentication"})}),e.jsxs(n.Body,{children:[i&&e.jsx(m,{variant:"info",children:i}),p?e.jsxs(e.Fragment,{children:[e.jsxs(m,{variant:"success",children:[e.jsx("i",{className:"bi bi-shield-check me-2"}),"Two-factor authentication is currently"," ",e.jsx("strong",{children:"enabled"}),"."]}),e.jsx("p",{className:"text-muted",children:"Store your recovery codes in a safe place. You can view them again, but they will not be shown again after this."}),e.jsx(a,{variant:"danger",onClick:b,disabled:disableForm?.processing,children:"Disable 2FA"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-muted",children:"Add additional security to your account using two-factor authentication."}),l?e.jsxs(r,{onSubmit:x,children:[e.jsx("p",{className:"fw-bold",children:"Scan this QR code with your authenticator app:"}),e.jsx("div",{className:"mb-3 text-center",children:e.jsx("img",{src:l,alt:"2FA QR Code",style:{maxWidth:"200px"}})}),e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Enter the 6-digit code from your app"}),e.jsx(r.Control,{type:"text",inputMode:"numeric",value:o.data.code,onChange:t=>o.setData("code",t.target.value),isInvalid:!!o.errors.code,placeholder:"123456"}),e.jsx(r.Control.Feedback,{type:"invalid",children:o.errors.code})]}),e.jsx(a,{variant:"success",type:"submit",disabled:o.processing,children:"Confirm & Enable"})]}):e.jsxs(r,{onSubmit:h,children:[e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{children:"Confirm your password to enable 2FA"}),e.jsx(r.Control,{type:"password",value:s.data.password,onChange:t=>s.setData("password",t.target.value),isInvalid:!!s.errors.password}),e.jsx(r.Control.Feedback,{type:"invalid",children:s.errors.password})]}),e.jsx(a,{variant:"primary",type:"submit",disabled:s.processing,children:"Enable"})]})]})]})]})})]})}export{L as default};
