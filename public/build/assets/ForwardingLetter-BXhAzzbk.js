import{r as d,j as t,R as f,H as A}from"./app-DLiJlaCC.js";import{A as L}from"./AuthenticatedLayout-DXwQPpw8.js";import{u as N,c as P,P as p,C as D,B as w}from"./ApplicationLogo-C9qI0V6g.js";import{R as b,C as h,a as y}from"./Row-720FVexg.js";import{D as F,F as B}from"./file-earmark-pdf-BmKdYuXp.js";import{A as k}from"./Alert-LYi_lLFc.js";import"./createLucideIcon-Yk7FCNie.js";import"./CloseButton-Cbdtb8Pf.js";import"./warning-BnHjIWto.js";import"./InputGroupContext-cvTZpN_9.js";const S=d.forwardRef(({bsPrefix:e,size:a,vertical:s=!1,className:r,role:i="group",as:l="div",...m},o)=>{const n=N(e,"btn-group");let c=n;return s&&(c=`${n}-vertical`),t.jsx(l,{...m,ref:o,role:i,className:P(r,c,a&&`${n}-${a}`)})});S.displayName="ButtonGroup";const $=d.forwardRef(({bsPrefix:e,variant:a,animation:s="border",size:r,as:i="div",className:l,...m},o)=>{e=N(e,"spinner");const n=`${e}-${s}`;return t.jsx(i,{ref:o,...m,className:P(l,n,r&&`${n}-${r}`,a&&`text-${a}`)})});$.displayName="Spinner";var H=["color","size","title","className"];function g(){return g=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var r in s)({}).hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},g.apply(null,arguments)}function I(e,a){if(e==null)return{};var s,r,i=U(e,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)s=l[r],a.indexOf(s)===-1&&{}.propertyIsEnumerable.call(e,s)&&(i[s]=e[s])}return i}function U(e,a){if(e==null)return{};var s={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(a.indexOf(r)!==-1)continue;s[r]=e[r]}return s}var O=d.forwardRef(function(e,a){var s=e.color,r=s===void 0?"currentColor":s,i=e.size,l=i===void 0?"1em":i,m=e.title,o=m===void 0?null:m,n=e.className,c=n===void 0?"":n,x=I(e,H);return f.createElement("svg",g({ref:a,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:l,height:l,fill:r,className:["bi","bi-printer",c].filter(Boolean).join(" ")},x),o?f.createElement("title",null,o):null,f.createElement("path",{d:"M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1"}),f.createElement("path",{d:"M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1"}))});O.propTypes={color:p.string,size:p.oneOfType([p.string,p.number]),title:p.string,className:p.string};const _=({pdfBase64:e,title:a="Document"})=>{const s=d.useRef(null);return d.useEffect(()=>{if(s.current&&e){const r=atob(e),i=new Array(r.length);for(let n=0;n<r.length;n++)i[n]=r.charCodeAt(n);const l=new Uint8Array(i),m=new Blob([l],{type:"application/pdf"}),o=URL.createObjectURL(m);return s.current.src=o,()=>URL.revokeObjectURL(o)}},[e]),t.jsx("iframe",{ref:s,title:a,style:{width:"100%",height:"400px",border:"none"}})},Y=({data:e,pdf:a,institutions:s,approvedApplicants:r,groupedApplicants:i})=>{const[l,m]=d.useState("all"),[o,n]=d.useState(!1),[c,x]=d.useState(a),[R,C]=d.useState(!0),[j,v]=d.useState(null);d.useEffect(()=>{a&&(x(a),C(!0),v(null))},[a]);const E=()=>{if(c){const u=document.createElement("a");u.href=`data:application/pdf;base64,${c}`,u.download=`forwarding-letter-${l}-${new Date().toISOString().split("T")[0]}.pdf`,u.click()}},z=()=>{if(c){const u=window.open("","_blank");u.document.write(`
                <html>
                    <head>
                        <title>Forwarding Letter</title>
                        <style>
                            body, html { margin: 0; padding: 0; height: 100%; }
                            embed { width: 100%; height: 100%; }
                        </style>
                    </head>
                    <body>
                        <embed src="data:application/pdf;base64,${c}" type="application/pdf" />
                    </body>
                </html>
            `),u.document.close(),setTimeout(()=>{u.print()},1e3)}};return t.jsxs(L,{children:[t.jsx(A,{title:"Forwarding Letter"}),t.jsxs(D,{fluid:!0,children:[t.jsxs(b,{className:"mb-4",children:[t.jsx(h,{children:t.jsxs("h4",{className:"mb-0",children:[e.type==="all"?"All Institutions":"Single Institution"," ","â€¢ ",e.applicants?.length||0," Students"]})}),t.jsx(h,{className:"text-end",children:t.jsxs(S,{className:"gap-2",children:[t.jsxs(w,{variant:"outline-primary",size:"sm",onClick:z,disabled:!c||o,className:"d-flex align-items-center gap-2 rounded",children:[t.jsx(O,{size:16}),"Print"]}),t.jsxs(w,{variant:"success",size:"sm",onClick:E,disabled:!c||o,className:"d-flex align-items-center gap-2 rounded",children:[t.jsx(F,{size:16}),"PDF"]})]})})]}),j&&t.jsx(b,{className:"mb-4",children:t.jsx(h,{children:t.jsx(k,{variant:"danger",onClose:()=>v(null),dismissible:!0,children:j})})}),t.jsx(b,{children:t.jsx(h,{children:t.jsx(y,{className:"border-0 shadow-sm",children:t.jsx(y.Body,{className:"p-0",children:o?t.jsxs("div",{className:"text-center py-5",children:[t.jsx($,{animation:"border",variant:"primary"}),t.jsx("p",{className:"mt-3 text-muted",children:"Generating forwarding letter..."})]}):R&&c?t.jsx(_,{pdfBase64:c,title:"Forwarding Letter"}):t.jsxs("div",{className:"text-center py-5",children:[t.jsx(B,{size:48,className:"text-muted mb-3"}),t.jsx("p",{className:"text-muted",children:"No PDF available. Please select an institution."})]})})})})})]})]})};export{Y as default};
